<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.gistone.mapper.St4ScsCdMapper">

    <!-- 通用查询映射结果 -->
    <resultMap id="BaseResultMap" type="com.gistone.entity.St4ScsCd">
        <id column="CD001" property="cd001" />
        <result column="CD002" property="cd002" />
        <result column="CD003" property="cd003" />
        <result column="CD004" property="cd004" />
        <result column="SG001" property="sg001" />
        <result column="CL001" property="cl001" />
        <result column="CD007" property="cd007" />
        <result column="SD001" property="sd001" />
        <result column="CD009" property="cd009" />
        <result column="CD010" property="cd010" />
        <result column="CD011" property="cd011" />
        <result column="CD012" property="cd012" />
        <result column="CD013" property="cd013" />
        <result column="CD014" property="cd014" />
        <result column="CD015" property="cd015" />

        <result column="image_id" property="imageId" />
        <result column="active_name" property="activeName" />
        <result column="active_type" property="activeType" />
        <result column="area" property="area" />
        <result column="descri" property="descri" />
        <result column="geometry" property="geometry" />
        <result column="group_id" property="groupId" />
        <association property="st4ScsCl" javaType="com.gistone.entity.St4ScsCl">
            <result column="CL001" property="cl001" />
            <result column="CL002" property="cl002" />
            <result column="CL003" property="cl003" />
        </association>
        <association property="st4ScsCo" javaType="com.gistone.entity.St4ScsCo">
            <id column="co001" property="co001" />
            <result column="name" property="name" />
            <result column="year" property="year" />
            <result column="admin_region" property="adminRegion" />
            <result column="create_by" property="createBy" />
            <result column="create_date" property="createDate" />
            <result column="update_by" property="updateBy" />
            <result column="update_date" property="updateDate" />
            <result column="remark" property="remark" />
            <result column="del_flag" property="delFlag" />
        </association>
        <association property="st4ScsCn" javaType="com.gistone.entity.St4ScsCn">
            <id column="CN001" property="cn001" />
            <result column="CK001" property="ck001" />
            <result column="CN010" property="cn010" />
        </association>
        <association property="st4SysSg" javaType="com.gistone.entity.St4SysSg">
            <id column="SG001" property="sg001" />
            <result column="SG008" property="sg008" />
        </association>
        <association property="st4SysSd" javaType="com.gistone.entity.St4SysSd">
            <id column="SD001" property="sd001" />
            <result column="SD008" property="sd008" />
        </association>
        <association property="st4ScsCk" javaType="com.gistone.entity.St4ScsCk">
            <id column="CK001" property="ck001" />
            <result column="CK002" property="ck002" />
            <result column="CD004" property="cd004" />
            <result column="SG001" property="sg001" />
            <result column="CK005" property="ck005" />
            <result column="CK006" property="ck006" />
            <result column="CK007" property="ck007" />
            <result column="CK008" property="ck008" />
            <result column="CK009" property="ck009" />
            <result column="CK010" property="ck010" />
            <result column="CK011" property="ck011" />
            <result column="CK012" property="ck012" />
            <result column="CK013" property="ck013" />
            <result column="CK014" property="ck014" />
            <result column="CK015" property="ck015" />
            <result column="CK016" property="ck016" />
            <result column="CK017" property="ck017" />
            <result column="CK018" property="ck018" />
            <result column="CK019" property="ck019" />
            <result column="CK020" property="ck020" />
            <result column="CK021" property="ck021" />
            <result column="CK022" property="ck022" />
            <result column="CK023" property="ck023" />
            <result column="CK024" property="ck024" />
            <result column="CK025" property="ck025" />
            <result column="CK026" property="ck026" />
            <result column="CK027" property="ck027" />
            <result column="CK028" property="ck028" />
            <result column="CK029" property="ck029" />
            <result column="CK030" property="ck030" />
            <result column="CK031" property="ck031" />
            <result column="CK032" property="ck032" />
            <result column="CK033" property="ck033" />
            <result column="CK034" property="ck034" />
            <result column="CK035" property="ck035" />
            <result column="CK036" property="ck036" />
            <result column="CK037" property="ck037" />
            <result column="CK038" property="ck038" />
            <result column="CK039" property="ck039" />
            <result column="CK040" property="ck040" />
            <result column="CK041" property="ck041" />
            <result column="CK042" property="ck042" />
            <result column="CK043" property="ck043" />
            <result column="CK044" property="ck044" />
            <result column="CK045" property="ck045" />
            <result column="CK046" property="ck046" />
            <result column="CK047" property="ck047" />
            <result column="CK048" property="ck048" />
            <result column="CK049" property="ck049" />
            <result column="CK050" property="ck050" />
            <result column="CK051" property="ck051" />
            <result column="CK052" property="ck052" />
            <result column="CK053" property="ck053" />
            <result column="CK054" property="ck054" />
            <result column="CK055" property="ck055" />
            <result column="CK056" property="ck056" />
            <result column="CK057" property="ck057" />
            <result column="CK058" property="ck058" />
            <result column="CK059" property="ck059" />
            <result column="CK060" property="ck060" />
            <result column="CK061" property="ck061" />
            <result column="CK062" property="ck062" />
            <result column="CK063" property="ck063" />
            <result column="CK064" property="ck064" />
            <result column="CK065" property="ck065" />
            <result column="CK066" property="ck066" />
            <result column="CK067" property="ck067" />
            <result column="CK068" property="ck068" />
            <result column="CK069" property="ck069" />
            <result column="CK070" property="ck070" />
            <result column="CK071" property="ck071" />
            <result column="CK072" property="ck072" />
            <result column="CC002" property="cc002" />
            <result column="CK074" property="ck074" />
            <result column="CK075" property="ck075" />
            <result column="CK076" property="ck076" />
            <result column="CK077" property="ck077" />
            <result column="CK078" property="ck078" />
            <result column="CK079" property="ck079" />
            <result column="CK080" property="ck080" />
            <result column="CK081" property="ck081" />
            <result column="CK082" property="ck082" />
            <result column="CK083" property="ck083" />
            <result column="CK084" property="ck084" />
            <result column="CK085" property="ck085" />
            <result column="CK086" property="ck086" />
            <result column="CK087" property="ck087" />
            <result column="CK088" property="ck088" />
            <result column="CK089" property="ck089" />
            <result column="CK090" property="ck090" />
            <result column="CK091" property="ck091" />
        </association>
        <collection property="st4PoCdSaList" ofType="com.gistone.entity.St4PoCdSa">
            <result column="CD001" property="cd001" />
            <result column="SA001" property="sa001" />
            <result column="CDSA001" property="cdsa001" />
            <result column="SA019" property="sa019" />
        </collection>
        <collection property="st4ScsCkList" ofType="com.gistone.entity.St4ScsCk">
            <id column="CK001" property="ck001" />
            <result column="CK002" property="ck002" />
            <result column="CD004" property="cd004" />
            <result column="SG001" property="sg001" />
            <result column="CK005" property="ck005" />
            <result column="CK006" property="ck006" />
            <result column="CK007" property="ck007" />
            <result column="CK008" property="ck008" />
            <result column="CK009" property="ck009" />
            <result column="CK010" property="ck010" />
            <result column="CK011" property="ck011" />
            <result column="CK012" property="ck012" />
            <result column="CK013" property="ck013" />
            <result column="CK014" property="ck014" />
            <result column="CK015" property="ck015" />
            <result column="CK016" property="ck016" />
            <result column="CK017" property="ck017" />
            <result column="CK018" property="ck018" />
            <result column="CK019" property="ck019" />
            <result column="CK020" property="ck020" />
            <result column="CK021" property="ck021" />
            <result column="CK022" property="ck022" />
            <result column="CK023" property="ck023" />
            <result column="CK024" property="ck024" />
            <result column="CK025" property="ck025" />
            <result column="CK026" property="ck026" />
            <result column="CK027" property="ck027" />
            <result column="CK028" property="ck028" />
            <result column="CK029" property="ck029" />
            <result column="CK030" property="ck030" />
            <result column="CK031" property="ck031" />
            <result column="CK032" property="ck032" />
            <result column="CK033" property="ck033" />
            <result column="CK034" property="ck034" />
            <result column="CK035" property="ck035" />
            <result column="CK036" property="ck036" />
            <result column="CK037" property="ck037" />
            <result column="CK038" property="ck038" />
            <result column="CK039" property="ck039" />
            <result column="CK040" property="ck040" />
            <result column="CK041" property="ck041" />
            <result column="CK042" property="ck042" />
            <result column="CK043" property="ck043" />
            <result column="CK044" property="ck044" />
            <result column="CK045" property="ck045" />
            <result column="CK046" property="ck046" />
            <result column="CK047" property="ck047" />
            <result column="CK048" property="ck048" />
            <result column="CK049" property="ck049" />
            <result column="CK050" property="ck050" />
            <result column="CK051" property="ck051" />
            <result column="CK052" property="ck052" />
            <result column="CK053" property="ck053" />
            <result column="CK054" property="ck054" />
            <result column="CK055" property="ck055" />
            <result column="CK056" property="ck056" />
            <result column="CK057" property="ck057" />
            <result column="CK058" property="ck058" />
            <result column="CK059" property="ck059" />
            <result column="CK060" property="ck060" />
            <result column="CK061" property="ck061" />
            <result column="CK062" property="ck062" />
            <result column="CK063" property="ck063" />
            <result column="CK064" property="ck064" />
            <result column="CK065" property="ck065" />
            <result column="CK066" property="ck066" />
            <result column="CK067" property="ck067" />
            <result column="CK068" property="ck068" />
            <result column="CK069" property="ck069" />
            <result column="CK070" property="ck070" />
            <result column="CK071" property="ck071" />
            <result column="CK072" property="ck072" />
            <result column="CC002" property="cc002" />
            <result column="CK074" property="ck074" />
            <result column="CK075" property="ck075" />
            <result column="CK076" property="ck076" />
            <result column="CK077" property="ck077" />
            <result column="CK078" property="ck078" />
            <result column="CK079" property="ck079" />
            <result column="CK080" property="ck080" />
            <result column="CK081" property="ck081" />
            <result column="CK082" property="ck082" />
            <result column="CK083" property="ck083" />
            <result column="CK084" property="ck084" />
            <result column="CK085" property="ck085" />
            <result column="CK086" property="ck086" />
            <result column="CK087" property="ck087" />
            <result column="CK088" property="ck088" />
            <result column="CK089" property="ck089" />
            <result column="CK090" property="ck090" />
            <result column="CK091" property="ck091" />
            <collection property="st4ScsCnList" ofType="com.gistone.entity.St4ScsCn">
                    <id column="CN001" property="cn001" />
                    <result column="CN002" property="cn002" />
                    <result column="CN003" property="cn003" />
                    <result column="CN004" property="cn004" />
                    <result column="CK001" property="ck001" />
                    <result column="CN005" property="cn005" />
                    <result column="CN006" property="cn006" />
                    <result column="CN007" property="cn007" />
                    <result column="CN008" property="cn008" />
                    <result column="CN009" property="cn009" />
                    <result column="CN010" property="cn010" />
            </collection>
        </collection>
    </resultMap>

    <!-- 通用查询结果列 -->
    <sql id="Base_Column_List">
        CD001, CD002, CD003, CD004, SG001, CL001, CD007, SD001, CD009, CD010, CD011, CD012, CD013, CD014, CD015
    </sql>
    <sql id="Base_Column_List1">
         CD002, CD003, CD004, SG001, CL001, CD007, SD001, CD009, CD010, CD011, CD012, CD013, CD014, CD015
    </sql>
    <sql id="ck_list">
         ck3.CK002, ck3.CD004, ck3.SG001, ck3.CK005, ck3.CK006, ck3.CK007, ck3.CK008, ck3.CK009, ck3.CK010, ck3.CK011, ck3.CK012, ck3.CK013, ck3.CK014, ck3.CK015, ck3.CK016, ck3.CK017, ck3.CK018, ck3.CK019, ck3.CK020, ck3.CK021, ck3.CK022, ck3.CK023, ck3.CK024, ck3.CK025, ck3.CK026, ck3.CK027, ck3.CK028, ck3.CK029, ck3.CK030, ck3.CK031, ck3.CK032, ck3.CK033, ck3.CK034, ck3.CK035, ck3.CK036, ck3.CK037, ck3.CK038, ck3.CK039, ck3.CK040, ck3.CK041, ck3.CK042, ck3.CK043, ck3.CK044, ck3.CK045, ck3.CK046, ck3.CK047, ck3.CK048, ck3.CK049, ck3.CK050, ck3.CK051, ck3.CK052, ck3.CK053, ck3.CK054, ck3.CK055, ck3.CK056, ck3.CK057, ck3.CK058, ck3.CK059, ck3.CK060, ck3.CK061, ck3.CK062, ck3.CK063, ck3.CK064, ck3.CK065, ck3.CK066, ck3.CK067, ck3.CK068, ck3.CK069, ck3.CK070, ck3.CK071, ck3.CK072, ck3.CC002, ck3.CK074, ck3.CK075, ck3.CK076, ck3.CK077, ck3.CK078, ck3.CK079, ck3.CK080, ck3.CK081, ck3.CK082, ck3.CK083, ck3.CK084, ck3.CK085, ck3.CK086, ck3.CK087, ck3.CK088, ck3.CK089, ck3.CK090, ck3.CK091
    </sql>

    <select id="getPointBySa001" resultMap="BaseResultMap" parameterType="Integer">
        select cd.*,cl.* from st4_scs_cd cd
        left join st4_po_cd_sa cdsa on cdsa.CD001 = cd.CD001
        inner join st4_sys_sa sa on sa.SA001 = cdsa.SA001
        left join st4_scs_cl cl on cl.CL001=cd.CL001
        WHERE  cd.CD009=1 and sa.SA001=#{sa001}
    </select>
    <insert id="insertList" parameterType="com.gistone.entity.St4ScsCd" useGeneratedKeys="true" keyProperty="cd001" >
        insert into st4_scs_cd (
        <include refid="Base_Column_List1" />
        )
        values
        <foreach collection="list" item="item" index="index"  separator=",">
            ( #{item.cd002,jdbcType=VARCHAR}, #{item.cd003,jdbcType=VARCHAR},
            #{item.cd004,jdbcType=VARCHAR}, #{item.sg001,jdbcType=INTEGER}, #{item.cl001,jdbcType=INTEGER},
            #{item.cd007,jdbcType=INTEGER}, #{item.sd001,jdbcType=INTEGER}, #{item.cd009,jdbcType=INTEGER},
            #{item.cd010,jdbcType=INTEGER}, #{item.cd011,jdbcType=TIMESTAMP}, #{item.cd012,jdbcType=VARCHAR})
        </foreach>
    </insert>
    <select id="getStaticPoint" resultMap="BaseResultMap" parameterType="com.gistone.entity.St4ScsCd">
        select
        cd.cd001,ck.cd004,
        IF(COUNT(*) IS NULL, 0, COUNT(*)) AS checkNum,
        IFNULL(SUM(ck088=0),0) AS uncheckNum,
        IFNULL(SUM(ck088=1),0) AS checkedNum,
        IFNULL(SUM(DATE_FORMAT(CK048,'%Y-%m-%d')=DATE_FORMAT(NOW(),'%Y-%m-%d')),0) AS todayNum,
        IFNULL(SUM(cd010!=0),0) AS addNum
        from st4_scs_cd cd
        LEFT JOIN st4_scs_ck ck on ck.CD004=cd.CD004
        left join st4_sys_sa sa on sa.SA001=cd.CD010
        LEFT JOIN st4_scs_cl cl ON cd.CL001 = cl.CL001
        WHERE  cd.CD009 =1 and sa.SA020=1

        <if test="st4ScsCl!=null">
            <if test="st4ScsCl.cl001!=null and st4ScsCl.cl001!='' ">
                and   cd.CL001=#{st4ScsCl.cl001}
            </if>
        </if>
        <if test="st4SysSa!=null">
            <if test="st4SysSa.sa001!=null and st4SysSa.sa001!='' ">
                and   sa.SA001=#{st4SysSa.sa001}
            </if>
        </if>
        <if test="groupByName==null or groupByName=='' ">
            GROUP BY cl.CL001
        </if>
        <if test="groupByName=='cl001' ">
            GROUP BY cl.CL001
        </if>
        <if test="groupByName=='sa001' ">
            GROUP BY sa.SA001
        </if>
    </select>
    <select id="listCheckPoint"  resultMap="BaseResultMap" parameterType="com.gistone.entity.St4ScsCd">
        select *,sa.SA019 uname
        from st4_scs_cd cd
        left join

        (
        SELECT *  FROM (
        SELECT MAX(CK001) AS ID FROM st4_scs_ck  GROUP BY CD004 )t
        INNER JOIN st4_scs_ck d ON t.ID= d.CK001
        )
        ck on cd.CD004=ck.CD004
        LEFT JOIN
        (
        SELECT *  FROM (
        SELECT MAX(CN001) AS ID FROM st4_scs_cn  GROUP BY ck001 )t
        INNER JOIN st4_scs_cn d ON t.ID= d.CN001
        )
        cn ON ck.CK001 = cn.CK001
        left join st4_scs_cl cl on cd.CL001 = cl.CL001
        left join st4_sys_sg sg on cd.SG001 = sg.SG001
        left join st4_sys_sd sd on cd.SD001 = sd.SD001
        LEFT JOIN st4_sys_sa sa ON cd.CD010 = sa.SA001

        where
        cd.CD009=1
        <if test="st4ScsCn!=null and st4ScsCn.cn010!=null">
            and cn.CN010 like '%${st4ScsCn.cn010}%'
        </if>
        <if test="st4ScsCk!=null and st4ScsCk.ck016!=null">
            and ck.CK016 like '%${st4ScsCk.ck016}%'
        </if>
        <if test="st4ScsCk!=null and  st4ScsCk.ck088!=null">
            and ck.CK088 = #{st4ScsCk.ck088}
        </if>
        <if test="cd004!=null">
            and cd.CD004 like '%${cd004}%'
        </if>
        <if test="sg001!=null">
            and cd.SG001=#{sg001}
        </if>
        <if test="cl001!=null">
            and cd.CL001=#{cl001}
        </if>
        <if test="type==0">
            and   sa.SA002 = #{sa01} or sa.SA001 = #{sa02} or cd.cd010=#{sa01}
        </if>
        <if test="type==1">
            and sa.SA001 = #{sa01}
        </if>
        <if test="sd001!=null">
            and cd.SD001=#{sd001}
        </if>
        order by  cd.CD011 desc
        <if test="pageSize!=null  and pageNumber!=null ">
            limit #{pageNumber},#{pageSize}
        </if>

    </select>
    <select id="batchSelectByCode"  resultMap="BaseResultMap" parameterType="java.util.List"  >
        select
        <include refid="Base_Column_List" />
        from st4_scs_cd
        where  CD009=1
        and CD004 in
        <foreach item="item" index="index"  collection="list" open="(" separator="," close=")">
            #{item}
        </foreach>
    </select>

    <select id="listCheckPointToView"  resultMap="BaseResultMap" parameterType="com.gistone.entity.St4ScsCd"  >
        select *
        from st4_scs_cd
        where  CD009=1
        <if test="sg001!=null">
            and SG001 = #{sg001}
        </if>
        <if test="strTime!=null and strTime!='' ">
            and CD011 <![CDATA[ >= ]]> #{strTime}
        </if>
        <if test="endTime!=null and endTime!='' ">
            and CD011 <![CDATA[ <= ]]> #{endTime}
        </if>

    </select>

    <select id="getDataByCd004"  resultMap="BaseResultMap" parameterType="com.gistone.entity.St4ScsCd"  >
        select *
        from st4_scs_cd
        where  CD009=1
        <if test="cd004!=null">
            and CD004 = #{cd004}
        </if>
    </select>

    <!--app同步问题点用-->
    <select id="sysPointAndLedgerDataLd" resultMap="BaseResultMap" parameterType="java.util.List">
        ( SELECT sa.sa001,sa.SA019,cd.*,
        cdsa.CDSA001,IFNULL(ck3.CK010,'') activityName,
        sg.*,cl.*,sd.*,cn.*,ck3.CK001,ck3.CK002, ck3.CD004, ck3.SG001, ck3.CK005, ck3.CK006, ck3.CK007, ck3.CK008, ck3.CK009, ck3.CK010, ck3.CK011, ck3.CK012, ck3.CK013, ck3.CK014, ck3.CK015, ck3.CK016, ck3.CK017, ck3.CK018, ck3.CK019, ck3.CK020, ck3.CK021, ck3.CK022, ck3.CK023, ck3.CK024, ck3.CK025, ck3.CK026, ck3.CK027, ck3.CK028, ck3.CK029, ck3.CK030, ck3.CK031, ck3.CK032, ck3.CK033, ck3.CK034, ck3.CK035, ck3.CK036, ck3.CK037, ck3.CK038, ck3.CK039, ck3.CK040, ck3.CK041, ck3.CK042, ck3.CK043, ck3.CK044, ck3.CK045, ck3.CK046, ck3.CK047, ck3.CK048, ck3.CK049, ck3.CK050, ck3.CK051, ck3.CK052, ck3.CK053, ck3.CK054, ck3.CK055, ck3.CK056, ck3.CK057, ck3.CK058, ck3.CK059, ck3.CK060, ck3.CK061, ck3.CK062, ck3.CK063, ck3.CK064, ck3.CK065, ck3.CK066, ck3.CK067, ck3.CK068, ck3.CK069, ck3.CK070, ck3.CK071, ck3.CK072, ck3.CC002, ck3.CK074, ck3.CK075, ck3.CK076, ck3.CK077, ck3.CK078, ck3.CK079, ck3.CK080, ck3.CK081, ck3.CK082, ck3.CK083, ck3.CK084, ck3.CK085, ck3.CK086, ck3.CK087, ck3.CK088, ck3.CK089, ck3.CK090, ck3.CK091
        FROM st4_scs_cd cd
        LEFT JOIN st4_po_cd_sa cdsa ON cd.CD001=cdsa.CD001
        left join st4_sys_sa sa on sa.SA001 = cdsa.SA001
        LEFT JOIN (SELECT ck2.* FROM st4_scs_ck ck2 INNER JOIN (SELECT MAX(CK001) AS CK001 FROM st4_scs_ck c WHERE CK085 = 1 AND CK088 = 0
        GROUP BY CD004) cks ON cks.CK001 = ck2.CK001 ) ck3 ON ck3.CD004 = cd.CD004
        LEFT JOIN st4_sys_sg sg ON cd.SG001=sg.SG001
        LEFT JOIN st4_scs_cl cl ON cd.CL001=cl.CL001
        LEFT JOIN st4_sys_sd sd ON cd.SD001 = SD.SD001
        LEFT JOIN st4_scs_cn cn ON ck3.CK001 = cn.CK001
        WHERE cd.CD009 = 1 AND

        cdsa.CD001 IN
        <foreach item="item" index="index"  collection="list" open="(" separator="," close=")">
            #{item}
        </foreach>
        AND ck3.CK001 IS NOT NULL
        ORDER BY CK086 DESC)



        UNION
        ( SELECT  sa.sa001,
        sa.SA019,cd.*,
        cdsa.CDSA001,IFNULL(ck3.CK010,'')activityName,sg.*,cl.*,sd.*,cn.*,ck3.CK001,ck3.CK002, ck3.CD004, ck3.SG001, ck3.CK005, ck3.CK006, ck3.CK007, ck3.CK008, ck3.CK009, ck3.CK010, ck3.CK011, ck3.CK012, ck3.CK013, ck3.CK014, ck3.CK015, ck3.CK016, ck3.CK017, ck3.CK018, ck3.CK019, ck3.CK020, ck3.CK021, ck3.CK022, ck3.CK023, ck3.CK024, ck3.CK025, ck3.CK026, ck3.CK027, ck3.CK028, ck3.CK029, ck3.CK030, ck3.CK031, ck3.CK032, ck3.CK033, ck3.CK034, ck3.CK035, ck3.CK036, ck3.CK037, ck3.CK038, ck3.CK039, ck3.CK040, ck3.CK041, ck3.CK042, ck3.CK043, ck3.CK044, ck3.CK045, ck3.CK046, ck3.CK047, ck3.CK048, ck3.CK049, ck3.CK050, ck3.CK051, ck3.CK052, ck3.CK053, ck3.CK054, ck3.CK055, ck3.CK056, ck3.CK057, ck3.CK058, ck3.CK059, ck3.CK060, ck3.CK061, ck3.CK062, ck3.CK063, ck3.CK064, ck3.CK065, ck3.CK066, ck3.CK067, ck3.CK068, ck3.CK069, ck3.CK070, ck3.CK071, ck3.CK072, ck3.CC002, ck3.CK074, ck3.CK075, ck3.CK076, ck3.CK077, ck3.CK078, ck3.CK079, ck3.CK080, ck3.CK081, ck3.CK082, ck3.CK083, ck3.CK084, ck3.CK085, ck3.CK086, ck3.CK087, ck3.CK088, ck3.CK089, ck3.CK090, ck3.CK091
        FROM st4_scs_cd cd
        LEFT JOIN st4_po_cd_sa cdsa ON cd.CD001=cdsa.CD001
        left join st4_sys_sa sa on sa.SA001 = cdsa.SA001
        inner JOIN (SELECT ck2.* FROM st4_scs_ck ck2 INNER JOIN (SELECT MAX(CK001) AS CK001 FROM st4_scs_ck c WHERE CK085 = 1 AND CK088 != 0 GROUP BY CD004) cks ON cks.CK001 = ck2.CK001 ) ck3 ON cd.CD004 = ck3.CD004
        LEFT JOIN st4_sys_sg sg ON cd.SG001=sg.SG001
        LEFT JOIN st4_scs_cl cl ON cd.CL001=cl.CL001
        LEFT JOIN st4_sys_sd sd ON cd.SD001 = SD.SD001
        LEFT JOIN st4_scs_cn cn ON ck3.CK001 = cn.CK001
        WHERE cd.CD009 = 1 AND
        cdsa.CD001 IN
        <foreach item="item" index="index"  collection="list" open="(" separator="," close=")">
            #{item}
        </foreach>
        )

    </select>




    <!--安徽下发任务接口的查询到的斑点的集合!-->
    <select id="getSpotByTaskId"  resultMap="BaseResultMap" parameterType="Integer">
        select cd.CD001 from
        iterpretation cd
        left join st4_po_cd_co cdco on cd.CD001 =cdco.cd001
        left join st4_scs_co co on cdco.co001 = co.co001
        LEFT JOIN st4_po_cl_co clco on  clco.co001=co.co001
        left join st4_scs_cl cl on cl.CL001 = clco.cl001
        where
         cd.CD009=1 and cl.CL001=#{cl001}
    </select>


</mapper>
