(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2b104778"],{"07b2":function(t,e,a){},"1e0c":function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"tablet"}},[a("div",{staticClass:"queryBox"},[a("QueryBox",{staticStyle:{width:"calc(100% - 150px)"},attrs:{formArr:t.queryFrom,id:"ProAppQuery"},on:{query:t.getQueryData}}),a("div",{staticClass:"queryBtns"},[a("Button",{staticClass:"exportBtn",attrs:{type:"primary",size:"small",icon:"md-cloud-download"},on:{click:t.handleExport}},[t._v("导出")]),a("Button",{staticClass:"btn-add",attrs:{type:"success",size:"small",icon:"md-add"},on:{click:function(e){e.stopPropagation(),t.addActive=!0,t.$refs.proAppAdd.initCom()}}},[t._v("新建")])],1)],1),a("div",{staticClass:"content_box"},[a("div",[a("Table",{attrs:{loading:t.loading,border:"",stripe:"",columns:t.columns1,data:t.data1,"highlight-row":"","max-height":t.tableHeight}}),a("div",{staticClass:"page_box"},[a("Page",{attrs:{total:t.total,"page-size":t.pageSize,"show-total":""},on:{"on-change":t.pageChange}})],1)],1)]),a("div",{staticClass:"add_box",class:{addActive:t.addActive}},[a("ProAppAdd",{ref:"proAppAdd",attrs:{seeId:t.seeId,fileUrl:t.fileUrl},on:{getNewList:t.getNewList,signOut:t.signOut}})],1)])},i=[],n=(a("28a5"),a("7f7f"),a("cadf"),a("551c"),a("f751"),a("097d"),a("aff7")),s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"proAppAdd"},[a("div",{ref:"viewDiv",class:{cursorPen:t.drawing&&("polyline"===t.drawType||"polygon"===t.drawType)},attrs:{id:"viewDiv"}}),a("div",{staticClass:"addForm"},[a("h3",[t._v("项目信息")]),a("hr",{staticStyle:{"margin-bottom":"15px"}}),a("div",[a("Form",{ref:"formValidate",attrs:{model:t.formItem,rules:t.ruleValidate,"label-width":90}},[a("FormItem",{staticStyle:{"margin-bottom":"18px"},attrs:{label:"项目名称",prop:"name"}},[a("Input",{attrs:{placeholder:"请输入项目名称",size:"small"},model:{value:t.formItem.name,callback:function(e){t.$set(t.formItem,"name","string"===typeof e?e.trim():e)},expression:"formItem.name"}})],1),a("FormItem",{staticStyle:{"margin-bottom":"18px"},attrs:{label:"项目时间",prop:"time"}},[a("DatePicker",{staticStyle:{width:"100%"},attrs:{editable:!1,type:"date",placement:"bottom-end",placeholder:"请选择项目时间",size:"small"},model:{value:t.formItem.time,callback:function(e){t.$set(t.formItem,"time","string"===typeof e?e.trim():e)},expression:"formItem.time"}})],1),a("FormItem",{staticStyle:{"margin-bottom":"18px"},attrs:{label:"属性",prop:"attribute"}},[a("Input",{attrs:{placeholder:"请输入属性",size:"small"},model:{value:t.formItem.attribute,callback:function(e){t.$set(t.formItem,"attribute","string"===typeof e?e.trim():e)},expression:"formItem.attribute"}})],1),a("FormItem",{staticStyle:{"margin-bottom":"18px"},attrs:{label:"类型",prop:"type"}},[a("Input",{attrs:{placeholder:"请输入类型",size:"small"},model:{value:t.formItem.type,callback:function(e){t.$set(t.formItem,"type","string"===typeof e?e.trim():e)},expression:"formItem.type"}})],1),a("FormItem",{staticStyle:{"margin-bottom":"18px"},attrs:{label:"缓冲区半径",prop:"radius"}},[a("Input",{staticStyle:{width:"80%"},attrs:{placeholder:"请输入缓冲区半径",size:"small"},model:{value:t.formItem.radius,callback:function(e){t.$set(t.formItem,"radius","string"===typeof e?e.trim():e)},expression:"formItem.radius"}}),a("span",{staticStyle:{"padding-left":"10px"}},[t._v("米")])],1),a("FormItem",{staticStyle:{"margin-bottom":"18px"},attrs:{label:"项目描述"}},[a("Input",{attrs:{type:"textarea",placeholder:"请输入项目描述",autosize:{maxRows:3,minRows:3}},model:{value:t.formItem.description,callback:function(e){t.$set(t.formItem,"description","string"===typeof e?e.trim():e)},expression:"formItem.description"}})],1),a("FormItem",{staticStyle:{"margin-bottom":"18px"},attrs:{label:"图层选择"}},[a("Select",{staticStyle:{width:"100%"},attrs:{size:"small"},model:{value:t.layers,callback:function(e){t.layers=e},expression:"layers"}},[a("Option",{attrs:{value:"redline"}},[t._v("红线斑块")]),a("Option",{attrs:{value:"natural",disabled:""}},[t._v("自然保护区")])],1)],1),a("FormItem",{staticStyle:{"margin-bottom":"18px"},attrs:{label:"项目形状"}},[a("ButtonGroup",{staticStyle:{width:"100%"}},[a("Button",{staticStyle:{width:"33%"},attrs:{size:"small",type:"point"===t.drawType?"primary":"default"},on:{click:function(e){t.drawType="point"}}},[a("Icon",{attrs:{type:"md-radio-button-on"}})],1),a("Button",{staticStyle:{width:"33%"},attrs:{size:"small",type:"polyline"===t.drawType?"primary":"default"},on:{click:function(e){t.drawType="polyline"}}},[a("Icon",{attrs:{type:"md-remove"}})],1),a("Button",{staticStyle:{width:"33%"},attrs:{size:"small",type:"polygon"===t.drawType?"primary":"default"},on:{click:function(e){t.drawType="polygon"}}},[a("Icon",{attrs:{type:"md-square"}})],1)],1)],1),a("FormItem",{staticStyle:{"margin-bottom":"5px",width:"100%"},attrs:{"label-width":0}},[a("ButtonGroup",{staticStyle:{width:"100%"},attrs:{size:"small"}},[a("Button",{staticStyle:{width:"50%"},attrs:{type:!0===t.drawing?"primary":"default"},on:{click:t.clickDraw}},[t._v("绘制")]),a("Button",{staticStyle:{width:"50%"}},[a("Upload",{staticStyle:{height:"19px"},attrs:{"show-upload-list":!1,format:[".xls"],"before-upload":t.handleUpload,action:"#"}},[a("span",{staticStyle:{display:"inline-block",width:"119px"}},[t._v("上传")])])],1)],1),a("p",{staticStyle:{"text-align":"right"}},[a("a",{attrs:{href:"/epr/excelModel/坐标.xls",download:"坐标模板.xls"}},[a("span",{staticStyle:{cursor:"pointer",color:"dodgerblue"}},[t._v("下载上传文件模板")])])]),t.drawValidate?a("p",{staticStyle:{height:"18px",color:"red","text-align":"right"}},[a("span",[t._v(t._s(t.validateText))])]):t._e()],1),a("FormItem",{staticStyle:{"text-align":"right","margin-bottom":"0"}},[a("Button",{ref:"analysis",staticStyle:{"margin-right":"15px"},attrs:{type:"primary",size:"small"},on:{click:t.analysis}},[t._v("分析")]),a("Button",{staticStyle:{"margin-right":"15px"},attrs:{type:"primary",size:"small",disabled:!t.analysisEnd},on:{click:t.addPro}},[t._v("保存")]),a("Button",{attrs:{type:"primary",size:"small"},on:{click:function(e){t.$emit("signOut",!1),t.analysisEnd=!1}}},[t._v("退出")])],1)],1)],1)]),a("div",{staticClass:"analysisList",class:{active:t.analysisList}},[a("ProAppAnalysis",{attrs:{data:t.analysisData,saveEnd:t.saveEnd,shapearea:t.shapearea,mapPhoto:t.dataUrl},on:{onclickDingwei:t.onclickDingwei}})],1),t.analysisSpin?a("Spin",{staticStyle:{background:"rgba(255, 255, 255, 0.5)","font-size":"18px",color:"#3B4EF5"},attrs:{fix:"",size:"large"}},[a("Icon",{staticClass:"demo-spin-icon-load",attrs:{type:"ios-loading",size:"22"}}),a("div",[t._v("分析计算中...")])],1):t._e()],1)},o=[],c=(a("ac6a"),a("e814")),l=a.n(c),d=(a("96cf"),a("3b8d")),u=(a("6b54"),a("f499")),p=a.n(u),h=a("bdb4"),m=a("9ed9"),f=a("149e"),y=a("f831"),g=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"proAppAnalysis"},[a("div",{staticClass:"analysis"},[a("h3",[t._v("分析条件")]),a("div",[a("p",[t._v("缓冲区半径："+t._s(t.data.radius))]),a("p",[t._v("绘制缓冲范围："+t._s(t.shapearea)+"平方米")])]),a("h3",[t._v("分析结果：")]),t.data.comState?t._e():a("div",[t._v("\n      结果计算中....\n    ")]),t.data.comState?a("div",[a("p",[t._v("相交结果："+t._s(t.data.result))]),a("p",{staticStyle:{"margin-bottom":"5px"}},[t._v("相交明细：")])]):t._e(),t.data.comState?a("div",{staticClass:"table_box"},[a("Table",{staticClass:"detailed",attrs:{columns:t.columns1,data:t.data.details,size:"small"}})],1):t._e()]),a("Button",{staticStyle:{position:"absolute",bottom:"20px",right:"20px"},attrs:{type:"primary",size:"small",disabled:""===t.data.fileUrl}},[a("a",{staticStyle:{color:"inherit",cursor:"pointer"},attrs:{href:t.data.fileUrl,download:t.data.name+"准入分析报告.docx"}},[t._v("\n      下载分析报告\n    ")])])],1)},w=[],b={name:"ProAppAnalysis",data:function(){var t=this;return{columns1:[{title:"相交斑块",key:"redineId",width:90},{title:"相交面积",key:"intersectArea",align:"center",render:function(t,e){return t("span",{},e.row.intersectArea+"平方米")}},{title:"操作",align:"center",width:80,render:function(e,a){return e("div",[e("Button",{props:{size:"small"},on:{click:function(){t.$emit("onclickDingwei",a.index)}}},"定位")])}}],data1:[],mapPhotos:"123456"}},props:{data:{default:{details:[]}},saveEnd:{},mapPhoto:{},shapearea:{}},mounted:function(){},methods:{}},v=b,x=(a("84d2"),a("eb03"),a("2877")),A=Object(x["a"])(v,g,w,!1,null,"1febe80e",null),k=A.exports,I=a("6b51"),j=a.n(I),O=a("cf45"),S={name:"ProAppAdd",data:function(){return{shapearea:0,id:"",formItem:{},layers:"redline",drawType:"point",shapeObj:{},analysisList:!1,drawing:!1,map:{},view:{},draw:{},bufferLayer:{},insercLayer:{},srldFeature:[],ruleValidate:{name:[{required:!0,message:"项目名称不能为空",trigger:"change"}],radius:[{required:!0,type:"string",message:"缓冲区半径不能为空",trigger:"change"}],attribute:[{required:!0,type:"string",message:"属性不能为空",trigger:"blue"}],type:[{required:!0,type:"string",message:"类型不能为空",trigger:"blur"}]},drawValidate:!1,validateText:"",buffer:{},comState:!1,file:null,loadingStatus:!1,excalData:[],analysisEnd:!1,saveEnd:!1,analysisSpin:!1,dataUrl:"",saveFileUrl:"",proportion:"1"}},computed:{intersect:function(){return 0===this.srldFeature.length?"不落在":"落在"},analysisArr:function(){var t=[];for(var e in this.srldFeature){var a={redineId:this.srldFeature[e].attributes.hxcode_1,intersectArea:(1*this.srldFeature[e].attributes.shapearea).toFixed(2)};t.push(a)}return t},analysisArea:function(){return(1*this.buffer.shapearea).toFixed(2)},analysisData:function(){var t={radius:this.formItem.radius+"米",area:this.analysisArea+"平方米",result:this.intersect,details:this.analysisArr,comState:this.comState,fileUrl:""===this.saveFileUrl?this.fileUrl:this.saveFileUrl,name:this.formItem.name};return t},coordinate:function(){if("{}"!==p()(this.shapeObj))switch(this.shapeObj.type){case"polygon":return this.shapeObj.rings[0];case"polyline":return this.shapeObj.paths[0];case"point":return[this.shapeObj.x,this.shapeObj.y]}return[]},addData:function(){var t={id:1*this.id,createBy:this.$store.getters.getloginInfor().userId,projectName:this.formItem.name,shape:this.drawType,radius:1*this.formItem.radius,result:this.intersect,bufferRange:this.shapearea.toString(),detail:this.analysisArr,coordinate:this.coordinate,image:this.dataUrl,proportion:this.proportion,description:this.formItem.description,time:this.formItem.time,attribute:this.formItem.attribute,type:this.formItem.type};return t}},props:{seeId:{},fileUrl:{}},components:{ProAppAnalysis:k},watch:{drawType:function(){this.drawing=!1,this.shapeObj={},this.view.graphics.removeAll(),this.map.remove(this.bufferLayer),this.map.remove(this.insercLayer)},seeId:function(){this.getProjectById(),this.id=this.seeId}},mounted:function(){this.createMap()},methods:{createMap:function(){var t=Object(d["a"])(regeneratorRuntime.mark(function t(){var e,a,r,i,n,s,o,c;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,m["a"].MapView;case 2:return e=t.sent,t.next=5,m["a"].Map;case 5:return a=t.sent,t.next=8,m["a"].Basemap;case 8:return r=t.sent,t.next=11,m["a"].Draw;case 11:return i=t.sent,t.next=14,Object(y["i"])().then(function(t){return t});case 14:return n=t.sent,t.next=17,Object(y["j"])().then(function(t){return t});case 17:return s=t.sent,t.next=20,Object(y["d"])().then(function(t){return t});case 20:o=t.sent,c=new r({baseLayers:[n,s,o],title:"Custom Basemap",id:"myBasemap"}),this.map=new a({basemap:c}),this.view=new e({map:this.map,container:"viewDiv",center:f["a"].centerPoint,spatialReference:{wkid:f["a"].mapWkid},zoom:7}),this.draw=new i({view:this.view});case 25:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),clickDraw:function(){if(this.drawing)this.drawing=!1,this.shapeObj={},this.view.graphics.removeAll(),this.action=this.draw.create(this.drawType);else if(this.shapeObj={},this.map.remove(this.bufferLayer),this.map.remove(this.insercLayer),this.drawing=!0,this.drawing)switch(this.action=this.draw.create(this.drawType),this.drawType){case"point":this.drawPoint(this.action);break;case"polyline":this.drawLine(this.action);break;case"polygon":this.drawPolygon(this.action);break}},drawPoint:function(){var t=Object(d["a"])(regeneratorRuntime.mark(function t(e){var a=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:e.on(["cursor-update","draw-complete"],function(t){a.renderPoint(t.coordinates)}),e.on(["draw-complete"],function(t){a.drawing=!1});case 2:case"end":return t.stop()}},t,this)}));function e(e){return t.apply(this,arguments)}return e}(),renderPoint:function(){var t=Object(d["a"])(regeneratorRuntime.mark(function t(e){var a,r,i,n;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,m["a"].Graphic;case 2:a=t.sent,this.view.graphics.removeAll(),r={type:"point",x:e[0],y:e[1],spatialReference:this.view.spatialReference},i={type:"picture-marker",url:j.a,height:20,width:20,yoffset:10,outline:{color:[255,255,255],width:1}},n=new a({geometry:r,symbol:i}),this.view.graphics.add(n),this.shapeObj=r;case 9:case"end":return t.stop()}},t,this)}));function e(e){return t.apply(this,arguments)}return e}(),drawLine:function(){var t=Object(d["a"])(regeneratorRuntime.mark(function t(e){var a=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:e.on(["vertex-add","vertex-remove","cursor-update","draw-complete"],function(t){a.renderLine(t.vertices)}),e.on(["draw-complete"],function(t){a.drawing=!1});case 2:case"end":return t.stop()}},t,this)}));function e(e){return t.apply(this,arguments)}return e}(),renderLine:function(){var t=Object(d["a"])(regeneratorRuntime.mark(function t(e){var a,r,i;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,m["a"].Graphic;case 2:a=t.sent,this.view.graphics.removeAll(),r={type:"polyline",paths:e,spatialReference:this.view.spatialReference},i=new a({geometry:r,symbol:{type:"simple-line",color:[51,133,255],width:2,cap:"round",join:"round"}}),this.view.graphics.add(i),this.shapeObj=r,this.shapeObj.paths=[this.shapeObj.paths];case 9:case"end":return t.stop()}},t,this)}));function e(e){return t.apply(this,arguments)}return e}(),drawPolygon:function(){var t=Object(d["a"])(regeneratorRuntime.mark(function t(e){var a=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:e.on(["vertex-add","vertex-remove","cursor-update","draw-complete"],function(t){a.renderPolygon(t.vertices)}),e.on(["draw-complete"],function(t){a.drawing=!1});case 2:case"end":return t.stop()}},t,this)}));function e(e){return t.apply(this,arguments)}return e}(),renderPolygon:function(){var t=Object(d["a"])(regeneratorRuntime.mark(function t(e){var a,r,i;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,m["a"].Graphic;case 2:a=t.sent,this.view.graphics.removeAll(),r={type:"polygon",rings:e,spatialReference:this.view.spatialReference},i=new a({geometry:r,symbol:{type:"simple-fill",color:[51,133,255,.5],style:"solid",outline:{color:[51,133,255,.8],width:1}}}),this.view.graphics.add(i),this.shapeObj=r,this.shapeObj.rings=[this.shapeObj.rings];case 9:case"end":return t.stop()}},t,this)}));function e(e){return t.apply(this,arguments)}return e}(),getbuffer:function(){var t=Object(d["a"])(regeneratorRuntime.mark(function t(){var e,a,r,i,n,s,o,c,d,u,p,h,y;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,m["a"].Graphic;case 2:return e=t.sent,t.next=5,m["a"].GraphicsLayer;case 5:return a=t.sent,t.next=8,m["a"].geometryEngine;case 8:return r=t.sent,t.next=11,m["a"].GeometryService;case 11:return i=t.sent,t.next=14,m["a"].BufferParameters;case 14:return n=t.sent,t.next=17,m["a"].AreasAndLengthsParameters;case 17:if(s=t.sent,o={type:"simple-fill",color:[140,140,222,.5],outline:{color:[140,140,222,.8],width:1}},c=new i({url:f["a"].geometryServerUrl}),"point"!==this.shapeObj.type){t.next=27;break}return t.next=23,m["a"].Point;case 23:d=t.sent,this.shapeObj=new d(this.shapeObj),t.next=39;break;case 27:if("polyline"!==this.shapeObj.type){t.next=34;break}return t.next=30,m["a"].Polyline;case 30:u=t.sent,this.shapeObj=new u(this.shapeObj),t.next=39;break;case 34:if("polygon"!==this.shapeObj.type){t.next=39;break}return t.next=37,m["a"].Polygon;case 37:p=t.sent,this.shapeObj=new p(this.shapeObj);case 39:if(h=new a,!this.view.spatialReference.isWGS84){t.next=46;break}return t.next=43,r.geodesicBuffer(this.shapeObj,this.formItem.radius,"meters",!1);case 43:this.buffer=t.sent,t.next=50;break;case 46:return t.next=48,c.buffer(new n({unit:"meters",outSpatialReference:this.view.spatialReference,geometries:[this.shapeObj],distances:[l()(this.formItem.radius)],geodesic:!0,bufferSpatialReference:this.view.spatialReference}));case 48:this.buffer=t.sent,this.buffer=this.buffer[0];case 50:return"polygon"===this.shapeObj.type&&(this.buffer=r.union([this.buffer,this.shapeObj]),this.buffer.rings=[this.buffer.rings[0]]),t.next=53,c.areasAndLengths(new s({calculationType:"geodesic",areaUnit:"square-meters",lengthUnit:"kilometers",polygons:[this.buffer]}));case 53:return y=t.sent,this.buffer.shapearea=y.areas[0],this.shapearea=y.areas[0].toFixed(2),this.graphic=new e({geometry:this.buffer,symbol:o}),this.map.remove(this.insercLayer),t.next=60,this.view.goTo(this.buffer.extent,{duration:600});case 60:h.add(this.graphic),this.map.add(h),this.bufferLayer=h;case 63:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),clickBtn:function(){var t=Object(d["a"])(regeneratorRuntime.mark(function t(){var e,a,r,i,n,s,o,c,l=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,m["a"].Geoprocessor;case 2:return e=t.sent,t.next=5,m["a"].FeatureSet;case 5:return a=t.sent,t.next=8,m["a"].GraphicsLayer;case 8:return r=t.sent,t.next=11,m["a"].geometryEngine;case 11:return t.sent,t.next=14,m["a"].GeometryService;case 14:return i=t.sent,t.next=17,m["a"].AreasAndLengthsParameters;case 17:return n=t.sent,s=new e(f["a"].GeoprocessorUrl),o=new a,o.features=[this.graphic],c={polygon:o,areafield:"mianji",redline:f["a"].redlineShpUrl},t.next=24,s.submitJob(c).then(function(t){"job-succeeded"===t.jobStatus?s.getResultData(t.jobId,"out").then(function(){var t=Object(d["a"])(regeneratorRuntime.mark(function t(e){var a,s,o,c,d;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:console.log(e),a={type:"simple-fill",color:[140,10,2,.7],outline:{color:[140,10,2,1],width:1}},s=new i({url:f["a"].geometryServerUrl}),o=0;case 4:if(!(o<e.value.features.length)){t.next=13;break}return e.value.features[o].symbol=a,t.next=8,s.areasAndLengths(new n({calculationType:"geodesic",areaUnit:"square-meters",lengthUnit:"kilometers",polygons:[e.value.features[o].geometry]}));case 8:c=t.sent,e.value.features[o].attributes.shapearea=c.areas[0];case 10:o++,t.next=4;break;case 13:return l.comState=!0,l.srldFeature=e.value.features,l.map.remove(l.insercLayer),d=new r,d.addMany(e.value.features),t.next=20,l.map.add(d);case 20:return l.insercLayer=d,l.analysisEnd=!0,t.next=24,setTimeout(function(){l.screenshot()},1e3);case 24:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()):console.log(t.jobStatus)});case 24:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),screenshot:function(){var t=this,e={x:this.buffer.extent.xmax,y:this.buffer.extent.ymax,spatialReference:{wkid:f["a"].mapWkid}},a={x:this.buffer.extent.xmin,y:this.buffer.extent.ymin,spatialReference:{wkid:f["a"].mapWkid}},r=this.view.toScreen(e),i=this.view.toScreen(a),n={x:Math.min(i.x,r.x)-20,y:Math.min(i.y,r.y)-20,width:Math.abs(r.x-i.x)+40,height:Math.abs(r.y-i.y)+40};this.proportion=(Math.abs(r.y-i.y)+40)/(Math.abs(r.x-i.x)+40),this.proportion=this.proportion.toString(),this.view.takeScreenshot({area:n,format:"png"}).then(function(e){t.dataUrl=e.dataUrl,t.analysisSpin=!1})},analysis:function(){var t=this;this.comState=!1,this.$refs["formValidate"].validate(function(e){e&&(t.analysisSpin=!0,"{}"!==p()(t.shapeObj)?"polygon"===t.shapeObj.type&&t.view.graphics.items[0].geometry.isSelfIntersecting?(t.validateText="请绘制闭合且不会自相交的多边形进行分析",t.view.graphics.removeAll(),t.drawValidate=!0,t.analysisSpin=!1):t.analysisDraw():(t.validateText="请先绘制或上传项目形状",t.drawValidate=!0,t.analysisList=!1,t.analysisSpin=!1))})},analysisDraw:function(){var t=Object(d["a"])(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return this.map.remove(this.bufferLayer),this.map.remove(this.insercLayer),this.drawValidate=!1,this.analysisList=!0,t.next=6,this.getbuffer();case 6:return t.next=8,this.clickBtn();case 8:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),onclickDingwei:function(t){var e=this,a=this.insercLayer.graphics.items;a.forEach(function(a,r){r===t?(a.symbol={type:"simple-fill",color:[12,140,2,.8],outline:{color:[0,0,0,.8],width:2}},e.view.goTo(a,{duration:600})):a.symbol={type:"simple-fill",color:[140,10,2,.8],outline:{color:[0,0,0,.8],width:2}}})},handleUpload:function(){var t=Object(d["a"])(regeneratorRuntime.mark(function t(e){var a,r,i=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,m["a"].WebMercatorUtils;case 2:a=t.sent,r=new FormData,r.append("file",e,e.name),Object(h["d"])(r).then(function(t){if("0000"===t.data.code){for(var e in i.excalData=[],t.data.data)null!==t.data.data[e][0]&&null!==t.data.data[e][1]&&i.excalData.push(a.lngLatToXY(t.data.data[e][0],t.data.data[e][1]));if(0===i.excalData.length)i.$Modal.warning({title:"警告",content:"请在模板文件中填充数据"});else switch(i.drawType){case"point":i.excalData.length>1&&i.$Modal.warning({title:"警告",content:"当项目形状为点,且excal文件中存在多个点时只显示第一个点"}),i.renderPoint(i.excalData[0]);break;case"polyline":i.renderLine(i.excalData);break;case"polygon":i.excalData[0]!==i.excalData[i.excalData.length-1]&&i.excalData.push(i.excalData[0]),i.renderPolygon(i.excalData);break}}});case 6:case"end":return t.stop()}},t,this)}));function e(e){return t.apply(this,arguments)}return e}(),addPro:function(){var t=this;this.$refs["formValidate"].validate(function(e){e&&Object(h["a"])({data:t.addData}).then(function(e){"0000"===e.data.code?(t.$Notice.success({title:"保存成功"}),t.id=e.data.data.id,t.saveFileUrl=e.data.data.fileUrl,t.saveEnd=!0,t.$emit("getNewList")):t.$Notice.error({title:e.data.msg})})})},getProjectById:function(){var t=Object(d["a"])(regeneratorRuntime.mark(function t(){var e=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(h["c"])({data:{id:this.seeId}}).then(function(t){if("0000"===t.data.code)switch(console.log(t.data.data),e.formItem.name=t.data.data.name,e.formItem.description=t.data.data.description,e.drawType=t.data.data.shape,e.$set(e.formItem,"type",t.data.data.type),e.$set(e.formItem,"attribute",t.data.data.attribute),e.$set(e.formItem,"time",new Date(t.data.data.time)),e.$set(e.formItem,"radius",t.data.data.radius.toString()),e.drawType){case"point":e.renderPoint(t.data.data.coordinate);break;case"polyline":e.renderLine(t.data.data.coordinate);break;case"polygon":e.renderPolygon(t.data.data.coordinate);break}}).catch(function(t){e.$Notice.error({title:"服务器错误"})});case 2:return t.next=4,this.analysis();case 4:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),initCom:function(){this.id="",this.formItem={},this.drawType="point",this.shapeObj={},this.analysisList=!1,this.$refs["formValidate"].resetFields(),this.analysisEnd=!1,this.saveEnd=!1,this.drawing=!1,this.map.remove(this.bufferLayer),this.map.remove(this.insercLayer),this.view.graphics.removeAll()}}},B=S,D=(a("d129"),Object(x["a"])(B,s,o,!1,null,"f6da33a2",null)),P=D.exports,L={name:"ActualTablet",data:function(){var t=this;return{queryData:{},tableHeight:window.innerHeight-312,columns1:[{title:"序号",key:"jzKh",align:"center",minWidth:100,render:function(e,a){return e("span",a.index+(t.pageNum-1)*t.pageSize+1)}},{title:"项目名称",key:"name",align:"center",minWidth:200},{title:"项目时间",key:"time",align:"center",width:120,render:function(t,e){return t("span",Object(O["e"])(e.row.time))},sortable:!0},{title:"属性",key:"attribute",align:"center",minWidth:150},{title:"类型",key:"type",align:"center",minWidth:150,sortable:!0},{title:"项目简介",key:"description",align:"center",minWidth:200},{title:"创建时间",key:"createDate",align:"center",width:120,render:function(t,e){return t("span",Object(O["e"])(e.row.createDate))}},{title:"分析结果",key:"result",align:"center",width:120},{title:"分析报告",key:"placeName",align:"center",width:100,render:function(t,e){return t("div",[t("Button",{props:{type:"success",size:"small",class:"btn-exportBtn",icon:"md-cloud-download"}},[t("a",{style:{color:"inherit",cursor:"pointer"},attrs:{href:e.row.fileUrl,download:e.row.name+"准入分析报告.docx"}},"下载")])])}},{title:"操作",key:"isBs",align:"center",width:170,render:function(e,a){return e("div",[e("Button",{props:{type:"primary",size:"small",icon:"md-eye"},style:{marginRight:"10px"},on:{click:function(){t.seeId=a.row.id,t.addActive=!0,t.fileUrl=a.row.fileUrl}}},"查看"),e("Button",{props:{type:"error",size:"small",icon:"md-trash"},on:{click:function(){t.$Modal.confirm({title:"确认",content:"请问您确定要删除该项目么？",onOk:function(){t.proDelete(a.row.id)},onCancel:function(){}})}}},"删除")])}}],data1:[],pageNum:1,pageSize:Math.floor((window.innerHeight-312)/48),total:0,loading:!1,addActive:!1,seeId:0,fileUrl:""}},components:{QueryBox:n["a"],ProAppAdd:P},computed:{queryFrom:function(){return[{type:1,field:"projectName",title:"项目名称"},{type:4,field:"time",title:"项目时间"},{type:1,field:"attribute",title:"属性"},{type:1,field:"type",title:"类型"}]}},watch:{queryData:function(){this.getTableData()}},created:function(){this.getTableData()},mounted:function(){var t=this;window.addEventListener("resize",function(){t.tableHeight=48*Math.floor((window.innerHeight-300-40)/48)+40,t.pageSize=Math.floor((48*Math.floor((window.innerHeight-300-40)/48)+40)/48),t.getTableData()},!1)},methods:{getQueryData:function(t){this.queryData=t,this.pageNum=1,this.getTableData()},getTableData:function(){var t=this;this.loading=!0;var e=this.queryData,a="",r="";e.time&&e.time.length>0&&(a=e.time[0],r=e.time[1]),Object(h["e"])({data:{pageNum:this.pageNum,pageSize:this.pageSize,attribute:e.attribute,projectName:e.projectName,type:e.type,startTime:a,endTime:r}}).then(function(e){t.data1=e.data.data.rows,t.total=e.data.data.total,t.loading=!1}).catch(function(){t.$Notice.error({title:"服务器错误"})})},proDelete:function(t){var e=this;Object(h["f"])({data:{id:t}}).then(function(){e.$Notice.success({title:"删除成功"}),e.getTableData()}).catch(function(){e.$Notice.error({title:"服务器错误"})})},pageChange:function(t){this.pageNum=t,this.getTableData()},signOut:function(t){this.addActive=t},getNewList:function(){this.getTableData(),this.pageNum=1},handleExport:function(){var t=this;Object(h["b"])({}).then(function(t){if("0000"===t.data.code){var e=t.data.data;if(!e)return;var a=document.createElement("a");a.style.display="none";var r=t.data.data.excelPath;a.href="/epr"+r,a.setAttribute("download",r.split("/")[r.split("/").length-1]),document.body.appendChild(a),a.click()}}).catch(function(){t.$Notice.error({title:"服务器错误"})})}}},U=L,M=(a("1eef"),Object(x["a"])(U,r,i,!1,null,"366aad9c",null));e["default"]=M.exports},"1eef":function(t,e,a){"use strict";var r=a("6ee0"),i=a.n(r);i.a},"2b06":function(t,e,a){},3391:function(t,e,a){},"6b51":function(t,e){t.exports="data:image/png;base64,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"},"6ee0":function(t,e,a){},"7f7f":function(t,e,a){var r=a("86cc").f,i=Function.prototype,n=/^\s*function ([^ (]*)/,s="name";s in i||a("9e1e")&&r(i,s,{configurable:!0,get:function(){try{return(""+this).match(n)[1]}catch(t){return""}}})},"84d2":function(t,e,a){"use strict";var r=a("07b2"),i=a.n(r);i.a},a21f:function(t,e,a){var r=a("584a"),i=r.JSON||(r.JSON={stringify:JSON.stringify});t.exports=function(t){return i.stringify.apply(i,arguments)}},bdb4:function(t,e,a){"use strict";a.d(e,"e",function(){return i}),a.d(e,"f",function(){return n}),a.d(e,"c",function(){return s}),a.d(e,"d",function(){return o}),a.d(e,"a",function(){return c}),a.d(e,"b",function(){return l});var r=a("b775"),i=function(t){return Object(r["a"])({url:"/ktdb/projectAdmission/list",method:"post",data:t})},n=function(t){return Object(r["a"])({url:"/ktdb/projectAdmission/delete",method:"post",data:t})},s=function(t){return Object(r["a"])({url:"/ktdb/projectAdmission/getProjectById",method:"post",data:t})},o=function(t){return Object(r["a"])({url:"/ktdb/projectAdmission/import",method:"post",headers:{"Content-Type":"multipart/form-data"},data:t})},c=function(t){return Object(r["a"])({url:"/ktdb/projectAdmission/add",method:"post",data:t})},l=function(t){return Object(r["a"])({url:"/ktdb/projectAdmission/exportExcel",method:"post",data:t})}},d129:function(t,e,a){"use strict";var r=a("3391"),i=a.n(r);i.a},eb03:function(t,e,a){"use strict";var r=a("2b06"),i=a.n(r);i.a},f499:function(t,e,a){t.exports=a("a21f")}}]);
//# sourceMappingURL=chunk-2b104778.5e2bf988.js.map