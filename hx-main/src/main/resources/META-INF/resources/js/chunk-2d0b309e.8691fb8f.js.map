{"version":3,"sources":["webpack:///./src/views/demo/demo.vue?dfd2","webpack:///src/views/demo/demo.vue","webpack:///./src/views/demo/demo.vue?0afa","webpack:///./src/views/demo/demo.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticStyle","height","attrs","id","on","click","clickBtn","_v","staticRenderFns","demovue_type_script_lang_js_","name","methods","createMap","_createMap","Object","asyncToGenerator","regeneratorRuntime","mark","_callee","MapView","Map","Basemap","Point","geometryEngine","GraphicLayer","Graphic","Polygon","polySym","lay","customBasemap","polygon","bufferLayer","_this","wrap","_context","prev","next","arcgisTools","sent","BaseTileLayer","Request","GraphicsLayer","FeatureLayer","WebTileLayer","type","color","outline","width","utils_layers","baseLayers","title","map","basemap","view","container","center","longitude","mapConfig","centerPoint","latitude","spatialReference","wkid","zoom","event","console","log","paths","rings","buffer","geodesicBuffer","union","pop","graphic","geometry","symbol","add","layerRedLine","evt","toMap","x","y","stop","apply","arguments","_clickBtn","_callee2","Geoprocessor","FeatureSet","gp","featureSet","params","_this2","_context2","ImageParameters","features","redline","submitJob","then","result","jobStatus","getResultData","jobId","res","graphicArr","value","feature","attributes","shapearea","geodesicArea","insercLayer","addMany","mounted","demo_demovue_type_script_lang_js_","component","componentNormalizer","__webpack_exports__"],"mappings":"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","file":"js/chunk-2d0b309e.8691fb8f.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('div',{staticStyle:{\"height\":\"500px\"},attrs:{\"id\":\"map\"}}),_c('Button',{on:{\"click\":_vm.clickBtn}},[_vm._v(\"按钮\")])],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div>\r\n    <div style=\"height: 500px\" id=\"map\">\r\n    </div>\r\n    <Button @click=\"clickBtn\">按钮</Button>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport config from '../../setting/mapConfig'\r\nimport arcgisPackage from '../../utils/arcgisTools'\r\nimport { tdtlayer } from '@/utils/layers'\r\nexport default {\r\n  name: 'demo',\r\n  methods: {\r\n    async createMap () {\r\n      let MapView = await arcgisPackage.MapView\r\n      let Map = await arcgisPackage.Map\r\n      let Basemap = await arcgisPackage.Basemap\r\n      let Point = await arcgisPackage.Point\r\n      let BaseTileLayer = await arcgisPackage.BaseTileLayer\r\n      let Request = await arcgisPackage.Request\r\n      let geometryEngine = await arcgisPackage.geometryEngine\r\n      let GraphicLayer = await arcgisPackage.GraphicsLayer\r\n      let Graphic = await arcgisPackage.Graphic\r\n      let FeatureLayer = await arcgisPackage.FeatureLayer\r\n      let Polygon = await arcgisPackage.Polygon\r\n      let WebTileLayer = await arcgisPackage.WebTileLayer\r\n      let polySym = {\r\n        type: 'simple-fill', // autocasts as new SimpleFillSymbol()\r\n        color: [140, 140, 222, 0.5],\r\n        outline: {\r\n          color: [0, 0, 0, 0.5],\r\n          width: 2\r\n        }\r\n      }\r\n\r\n      /* this.layerRedLine = new FeatureLayer({\r\n        url: config.serverUrl + '/arcgis/rest/services/qhhx/hongxian/MapServer',\r\n        opacity: 0.7,\r\n        outFields: ['*'],\r\n        popupTemplate: {\r\n          title: '{name}',\r\n          content: [\r\n            {\r\n              type: 'fields',\r\n              fieldInfos: [{\r\n                fieldName: 'STATENAME',\r\n                label: '所属地区'\r\n              }, {\r\n                fieldName: '面积',\r\n                label: '面积（平方米）'\r\n              }]\r\n            }\r\n          ]\r\n        }\r\n      }) */\r\n\r\n      // 天地图影像地图\r\n      /* let TDT = BaseTileLayer.createSubclass({\r\n        properties: {\r\n          urlTemplate: null\r\n        },\r\n        getTileUrl: function (level, row, col) {\r\n          let url = 'http://t' + col % 8 + '.tianditu.gov.cn/DataServer?T=img_w&tk=12b886b3d0f324bd6032c29503972e7c&x=' + col + '&y=' + row + '&l=' + level\r\n          // var url = \"http://t0.tianditu.gov.cn/cva_w/wmts?SERVICE=WMTS&REQUEST=GetTile&VERSION=1.0.0&LAYER=img&STYLE=default&TILEMATRIXSET=w&FORMAT=tiles&TILEMATRIX=\"+level+\"&TILEROW=\"+row+\"&TILECOL=\"+col+\"&tk=12b886b3d0f324bd6032c29503972e7c\";\r\n          return url\r\n        },\r\n        fetchTile: function (level, row, col) {\r\n          let url = this.getTileUrl(level, row, col)\r\n          return Request(url, {\r\n            responseType: 'image'\r\n          })\r\n            .then((response) => {\r\n              let image = response.data\r\n              let width = this.tileInfo.size[0]\r\n              let height = this.tileInfo.size[0]\r\n\r\n              let canvas = document.createElement('canvas')\r\n              let context = canvas.getContext('2d')\r\n              canvas.width = width\r\n              canvas.height = height\r\n\r\n              context.drawImage(image, 0, 0, width, height)\r\n\r\n              return canvas\r\n            })\r\n        }\r\n      })\r\n\r\n      let tdtylayer = new TDT() */\r\n\r\n      /* let td = new WebTileLayer({\r\n        urlTemplate: 'http://t2.tianditu.gov.cn/img_c/wmts?tk=12b886b3d0f324bd6032c29503972e7c&TILECOL={col}&TILEROW={row}&TILEMATRIX={level}&REQUEST=GetTile&VERSION=1.0.0&LAYER=img&STYLE=default&TILEMATRIXSET=c&FORMAT=tiles&SERVICE=WMTS'\r\n      }) */\r\n      let lay = await new tdtlayer()\r\n      let customBasemap = new Basemap({\r\n        baseLayers: [ lay ],\r\n        title: 'Custom Basemap',\r\n        id: 'myBasemap'\r\n      })\r\n\r\n      this.map = new Map({\r\n        basemap: customBasemap\r\n      })\r\n      this.view = new MapView({\r\n        map: this.map,\r\n        container: 'map',\r\n        center: {\r\n          longitude: config.centerPoint[0],\r\n          latitude: config.centerPoint[1],\r\n          spatialReference: {\r\n            wkid: 4490\r\n          }\r\n        },\r\n        zoom: 7\r\n      })\r\n      this.view.on('click', event => {\r\n        console.log(event)\r\n      })\r\n      let point = new Point({\r\n        type: 'point',\r\n        longitude: 98.880521,\r\n        latitude: 38.762178\r\n      })\r\n\r\n      let polyline = {\r\n        type: 'polyline',\r\n        paths: [\r\n          [\r\n            [98.880521, 38.762178],\r\n            [98.990521, 38.772178]\r\n          ]\r\n        ],\r\n        spatialReference: { wkid: 4326 }\r\n      }\r\n      let polygon = new Polygon({\r\n        rings: [\r\n          [\r\n            [98.880521, 38.762178],\r\n            [98.990521, 38.972178],\r\n            [98.790521, 38.672178],\r\n            [98.880521, 38.762178]\r\n          ]\r\n        ],\r\n        spatialReference: { wkid: 4326 }\r\n      })\r\n      let bufferLayer = new GraphicLayer()\r\n      this.buffer = geometryEngine.geodesicBuffer(polygon, 0.5, 'kilometers', false)\r\n      this.buffer = geometryEngine.union([this.buffer, polygon])\r\n      // console.log(this.buffer.rings[1])\r\n      this.buffer.rings.pop()\r\n      // this.buffer.removeRing(this.buffer.rings[1])\r\n      this.graphic = new Graphic({\r\n        geometry: this.buffer,\r\n        symbol: polySym\r\n      })\r\n      bufferLayer.add(this.graphic)\r\n      // this.map.add(td)\r\n      this.map.add(this.layerRedLine)\r\n      this.map.add(bufferLayer)\r\n      this.bufferLayer = bufferLayer\r\n\r\n      this.view.on('pointer-move', evt => {\r\n        point = this.view.toMap({ x: evt.x, y: evt.y })\r\n        /* console.log(mp.x + '-' + mp.y) */\r\n      })\r\n    },\r\n    async clickBtn () {\r\n      let Geoprocessor = await arcgisPackage.Geoprocessor\r\n      let FeatureSet = await arcgisPackage.FeatureSet\r\n      let ImageParameters = await arcgisPackage.ImageParameters\r\n      let Graphic = await arcgisPackage.Graphic\r\n      let GraphicLayer = await arcgisPackage.GraphicsLayer\r\n      let geometryEngine = await arcgisPackage.geometryEngine\r\n      // let gp = new Geoprocessor('http://192.168.1.158:6080/arcgis/rest/services/qhhx/intersect/GPServer/intersect')\r\n      let gp = new Geoprocessor('http://192.168.1.158:6080/arcgis/rest/services/qhhx/insect/GPServer/insect')\r\n\r\n      let featureSet = new FeatureSet()\r\n\r\n      featureSet.features = [this.graphic]\r\n      /* let params = {\r\n        polygon: featureSet,\r\n        redline: 'wgs'\r\n      } */\r\n\r\n      let params = {\r\n        polygon: featureSet,\r\n        redline: 'redline_Project'\r\n      }\r\n      console.log(featureSet)\r\n      gp.submitJob(params).then(result => {\r\n        if (result.jobStatus === 'job-succeeded') {\r\n          gp.getResultData(result.jobId, 'out').then(res => {\r\n            console.log(res)\r\n            let polySym = {\r\n              type: 'simple-fill', // autocasts as new SimpleFillSymbol()\r\n              color: [140, 10, 2, 0.8],\r\n              outline: {\r\n                color: [0, 0, 0, 0.8],\r\n                width: 2\r\n              }\r\n            }\r\n            let graphicArr = res.value.features.map(feature => {\r\n              feature.symbol = polySym\r\n              // 计算面积\r\n              feature.attributes.shapearea = geometryEngine.geodesicArea(feature.geometry, 'square-meters')\r\n              return feature\r\n            })\r\n            let insercLayer = new GraphicLayer()\r\n            insercLayer.addMany(graphicArr)\r\n            this.map.add(insercLayer)\r\n          })\r\n        }\r\n      })\r\n    }\r\n  },\r\n  mounted () {\r\n    this.createMap()\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n\r\n</style>\r\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./demo.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./demo.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./demo.vue?vue&type=template&id=1f5f6602&scoped=true&\"\nimport script from \"./demo.vue?vue&type=script&lang=js&\"\nexport * from \"./demo.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"1f5f6602\",\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}