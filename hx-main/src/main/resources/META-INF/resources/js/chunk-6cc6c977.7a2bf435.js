(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6cc6c977"],{"39f3":function(t,e,a){t.exports=a.p+"img/Basemapthumbnail1.5f8d6db2.png"},"3ac9":function(t,e,a){"use strict";a.d(e,"j",function(){return n}),a.d(e,"i",function(){return i}),a.d(e,"k",function(){return o}),a.d(e,"g",function(){return s}),a.d(e,"h",function(){return c}),a.d(e,"e",function(){return u}),a.d(e,"f",function(){return d}),a.d(e,"d",function(){return l}),a.d(e,"l",function(){return p}),a.d(e,"c",function(){return f}),a.d(e,"a",function(){return m}),a.d(e,"b",function(){return h});var r=a("b775"),n=function(t){return Object(r["a"])({url:"/ktdb/lmPoint/getPointList",method:"post",data:t})},i=function(t){return Object(r["a"])({url:"/sys/menu/getMenu",method:"post",data:t})},o=function(t){return Object(r["a"])({url:"/ktdb/lmMarkerMobile/getPreMarkerList",method:"post",data:t})},s=function(t){return Object(r["a"])({url:"/ktdb/lmBoard/getPreLmBoardList",method:"post",data:t})},c=function(t){return Object(r["a"])({url:"/ktdb/lmMarkerMobile/getMarkerByCoordinate",method:"post",data:t})},u=function(t){return Object(r["a"])({url:"/ktdb/lmPoint/export_Excel",method:"post",data:t})},d=function(t){return Object(r["a"])({url:"/ktdb/lmMarkerMobile/export_PreExcel",method:"post",data:t})},l=function(t){return Object(r["a"])({url:"/ktdb/lmBoard/export_PreExcel",method:"post",data:t})},p=function(t){return Object(r["a"])({url:"ktdb/dataRedlineRegister/list",method:"post",data:t})},f=function(t){return Object(r["a"])({url:"ktdb/environment/bottomChart/list",method:"post",data:t})},m=function(t){return Object(r["a"])({url:"ktdb/environment/bottomChart/add",method:"post",data:t})},h=function(t){return Object(r["a"])({url:"ktdb/environment/bottomChart/delete",method:"post",data:t})}},"42e8":function(t,e,a){t.exports=a.p+"img/Basemapthumbnail.6dc37597.png"},"52f4":function(t,e,a){},"72c0":function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"tablet"}},[a("div",{staticClass:"queryBox"},[a("QueryBox",{ref:"getQuery",staticStyle:{width:"calc(100% - 80px)"},attrs:{formArr:t.queryFrom},on:{query:t.getQueryData}}),a("div",{staticClass:"queryBtns"},[a("Button",{staticClass:"btn-add",attrs:{type:"success",size:"small",icon:"md-add"},on:{click:function(e){e.stopPropagation(),t.$refs.reproduction.reproductionBuild=!0}}},[t._v("新建")])],1)],1),a("div",{staticClass:"content_box"},[a("div",[a("Table",{attrs:{border:"",stripe:"",loading:t.loading,columns:t.columns1,data:t.data1,"highlight-row":"","max-height":t.tableHeight}}),a("div",{staticClass:"page_box"},[a("Page",{attrs:{total:t.total,"page-size":t.pageSize,"show-total":""},on:{"on-change":t.pageChange}})],1)],1)]),a("div",{staticClass:"checking_box",class:{addActive:t.addActive}},[a("checkInfoMap",{ref:"checkInfoMap",attrs:{serviceUrl:t.serviceUrl},on:{signOut:t.signOut}})],1),a("reproductionAdd",{ref:"reproduction",on:{getTableData:t.getClearQueryData}})],1)},n=[],i=a("cebc"),o=a("aff7"),s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"map-box"},[a("div",{ref:"viewDiv",attrs:{id:"viewDiv"}}),a("Button",{staticClass:"sign-btn",attrs:{type:"primary",size:"small",icon:"ios-arrow-back"},on:{click:function(e){return t.$emit("signOut",!1)}}},[t._v("返回")])],1)},c=[],u=(a("96cf"),a("3b8d")),d=a("9ed9"),l=a("149e"),p=a("f831"),f=a("42e8"),m=a.n(f),h=a("39f3"),b=a.n(h),g={name:"checkInfoMap",data:function(){return{map:{},view:{}}},computed:{},props:{serviceUrl:String},components:{},watch:{},mounted:function(){this.createMap()},methods:{createMap:function(){var t=Object(u["a"])(regeneratorRuntime.mark(function t(){var e,a,r,n,i,o,s,c,u,f,h;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,d["a"].MapView;case 2:return e=t.sent,t.next=5,d["a"].Map;case 5:return a=t.sent,t.next=8,d["a"].Basemap;case 8:return r=t.sent,t.next=11,d["a"].FeatureLayer;case 11:return t.sent,t.next=14,d["a"].BasemapToggle;case 14:return n=t.sent,t.next=17,Object(p["h"])().then(function(t){return t});case 17:return i=t.sent,t.next=20,Object(p["g"])().then(function(t){return t});case 20:return o=t.sent,t.next=23,Object(p["f"])().then(function(t){return t});case 23:return s=t.sent,t.next=26,Object(p["i"])().then(function(t){return t});case 26:c=t.sent,u=new r({baseLayers:[o,s],title:"矢量地图",id:"myBasemap",thumbnailUrl:m.a}),f=new r({baseLayers:[i,c],title:"影像地图",id:"myBasemap1",thumbnailUrl:b.a}),this.map=new a({basemap:f}),this.view=new e({map:this.map,container:"viewDiv",center:l["a"].centerPoint,zoom:7}),h=new n({view:this.view,nextBasemap:u}),this.view.ui.add(h,"top-right");case 33:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),addFeatureLayer:function(){var t=Object(u["a"])(regeneratorRuntime.mark(function t(){var e,a;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,d["a"].FeatureLayer;case 2:e=t.sent,a=new e({url:this.serviceUrl,outFields:["*"]}),this.map.layers.add(a);case 5:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),addTileLayer:function(){var t=Object(u["a"])(regeneratorRuntime.mark(function t(){var e,a;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,d["a"].MapImageLayer;case 2:e=t.sent,a=new e({url:this.serviceUrl}),this.map.layers.add(a);case 5:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),addTileRestLayer:function(){var t=Object(u["a"])(regeneratorRuntime.mark(function t(){var e,a;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,d["a"].TileLayer;case 2:e=t.sent,a=new e({url:this.serviceUrl}),this.map.layers.add(a);case 5:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),addWMSLayer:function(){var t=Object(u["a"])(regeneratorRuntime.mark(function t(){var e,a;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,d["a"].WMSLayer;case 2:e=t.sent,a=new e({url:this.serviceUrl}),this.map.layers.add(a);case 5:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),addWMTSLayer:function(){var t=Object(u["a"])(regeneratorRuntime.mark(function t(){var e,a;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,d["a"].WMTSLayer;case 2:e=t.sent,a=new e({url:this.serviceUrl}),this.map.layers.add(a);case 5:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),initCom:function(t){switch(this.map.remove(this.insercLayer),this.map.layers.removeAll(),t){case 0:this.addTileLayer();break;case 1:this.addFeatureLayer();break;case 2:this.addTileRestLayer();break;case 3:this.addWMSLayer();break;case 4:this.addWMTSLayer();break;default:break}}}},v=g,y=(a("e43f"),a("2877")),w=Object(y["a"])(v,s,c,!1,null,"70c49889",null),k=w.exports,x=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"taskAdd"}},[a("Modal",{attrs:{title:"新建地图图层"},on:{"on-cancel":t.reset},model:{value:t.reproductionBuild,callback:function(e){t.reproductionBuild=e},expression:"reproductionBuild"}},[a("Form",{ref:"add",staticStyle:{padding:"0 50px"},attrs:{model:t.AddData,rules:t.ruleValidate,"label-width":90}},[a("FormItem",{attrs:{prop:"name",label:"图层名称："}},[a("Input",{attrs:{placeholder:"请输入图层名称",size:"default"},model:{value:t.AddData.name,callback:function(e){t.$set(t.AddData,"name","string"===typeof e?e.trim():e)},expression:"AddData.name"}})],1),a("FormItem",{attrs:{prop:"type",label:"服务类型："}},[a("Select",{model:{value:t.AddData.type,callback:function(e){t.$set(t.AddData,"type",e)},expression:"AddData.type"}},[a("Option",{attrs:{value:0}},[t._v("影像REST服务")]),a("Option",{attrs:{value:1}},[t._v("矢量REST服务")]),a("Option",{attrs:{value:2}},[t._v("影像瓦片REST服务")]),a("Option",{attrs:{value:3}},[t._v("WMS")]),a("Option",{attrs:{value:4}},[t._v("WMTS")])],1)],1),a("FormItem",{attrs:{prop:"url",label:"访问地址："}},[a("Input",{attrs:{placeholder:"请输入访问地址",size:"default"},model:{value:t.AddData.url,callback:function(e){t.$set(t.AddData,"url","string"===typeof e?e.trim():e)},expression:"AddData.url"}})],1)],1),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("Button",{attrs:{type:"primary"},on:{click:t.addSubmit}},[t._v("确定")])],1)],1)],1)},O=[],M=(a("7f7f"),a("3ac9")),S={name:"TaskAdd",data:function(){return{AddData:{name:"",url:"",type:0,createBy:12},ruleValidate:{name:[{required:!0,message:"任务名称必须填写",trigger:"blur"}],url:[{required:!0,message:"任务名称必须填写",trigger:"blur"}]},reproductionBuild:!1}},methods:{addSubmit:function(){var t=this;this.$refs.add.validate(function(e){e&&Object(M["a"])({data:{name:t.AddData.name,url:t.AddData.url,type:t.AddData.type,createBy:t.AddData.createBy}}).then(function(e){"0000"===e.data.code?(t.$emit("getTableData"),t.$Notice.success({title:"创建图层成功"}),t.reproductionBuild=!1,t.AddData={name:"",url:"",createBy:12},t.reset()):t.$Message.info(e.data.msg)})})},reset:function(){this.AddData={name:"",url:"",type:0,createBy:12},this.$refs.add.resetFields()}}},D=S,j=Object(y["a"])(D,x,O,!1,null,"588a3bb9",null),B=j.exports,L={name:"DataTable",data:function(){var t=this;return{tableHeight:48*Math.floor((window.innerHeight-300-40)/48)+40,queryData:{},columns1:[{title:"序号",key:"index",width:100,align:"center",render:function(e,a){return e("span",a.index+(t.pageNum-1)*t.pageSize+1)}},{title:"图层名称",align:"center",minWidth:150,key:"name"},{title:"创建时间",align:"center",width:250,key:"createDate"},{title:"访问地址",align:"center",minWidth:150,key:"url"},{title:"服务类型",align:"center",minWidth:80,render:function(t,e){var a="";switch(e.row.type){case 0:a="影像REST服务";break;case 1:a="矢量REST服务";break;case 2:a="影像瓦片REST服务";break;case 3:a="WMS";break;case 4:a="WMTS";break;case 5:a="";break;default:break}return t("span",a)}},{title:"操作",key:"address",width:170,align:"center",render:function(e,a){return e("div",[e("Button",{props:{type:"primary",size:"small",icon:"md-eye"},style:{marginRight:"5px"},on:{click:function(){t.addActive=!0,t.serviceUrl=a.row.url,t.$refs.checkInfoMap.initCom(a.row.type)}}},"查看"),e("Button",{props:{type:"error",size:"small",icon:"md-trash"},on:{click:function(){t.infoId=a.row.id,t.$Modal.confirm({title:"确认",content:"请问您确定要删除该图层吗？",onOk:function(){t.infoDel()},onCancel:function(){}})}}},"删除")])}}],data1:[],obj:{},total:0,pageNum:1,pageSize:Math.floor((48*Math.floor((window.innerHeight-300-40)/48)+40)/48),infoId:"",loading:!1,addActive:!1,serviceUrl:""}},components:{QueryBox:o["a"],checkInfoMap:k,reproductionAdd:B},computed:{queryFrom:function(){return[{type:1,field:"name",title:"图层名称"}]}},created:function(){this.getSurveyTableList()},mounted:function(){var t=this;window.addEventListener("resize",function(){t.pageSize=Math.floor((window.innerHeight-350)/48)+1,t.getSurveyTableList()},!1)},methods:{getQueryData:function(t){this.queryData=t,this.pageNum=1,this.getSurveyTableList()},getClearQueryData:function(){this.queryData={},this.pageNum=1,this.getSurveyTableList(),this.$refs.getQuery.cleardata()},getSurveyTableList:function(){var t=this;this.loading=!0,Object(M["c"])({data:Object(i["a"])({pageSize:this.pageSize,pageNum:this.pageNum},this.queryData)}).then(function(e){"0000"===e.data.code&&(t.data1=e.data.data.rows,t.total=e.data.data.total,t.loading=!1)}).catch(function(){t.$Notice.error({title:"服务器错误"})})},pageChange:function(t){this.pageNum=t,this.getSurveyTableList()},infoDel:function(){var t=this;Object(M["b"])({data:{id:[this.infoId]}}).then(function(e){"0000"===e.data.code?(t.getSurveyTableList(),t.$Notice.success({title:"删除成功"})):t.$Notice.error({title:"删除失败"})}).catch(function(){t.$Notice.error({title:"服务器错误"})})},signOut:function(t){this.addActive=t}}},T=L,A=(a("940e"),Object(y["a"])(T,r,n,!1,null,"79e9a571",null));e["default"]=A.exports},"7f7f":function(t,e,a){var r=a("86cc").f,n=Function.prototype,i=/^\s*function ([^ (]*)/,o="name";o in n||a("9e1e")&&r(n,o,{configurable:!0,get:function(){try{return(""+this).match(i)[1]}catch(t){return""}}})},"940e":function(t,e,a){"use strict";var r=a("d78e"),n=a.n(r);n.a},d78e:function(t,e,a){},e43f:function(t,e,a){"use strict";var r=a("52f4"),n=a.n(r);n.a}}]);
//# sourceMappingURL=chunk-6cc6c977.7a2bf435.js.map