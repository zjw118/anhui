(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-8d469e5c"],{aa1f:function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"map-box"},[n("div",{ref:"viewDiv",attrs:{id:"viewDiv"}}),n("div",{attrs:{id:"legendbar"}},[n("span",[e._v("图例")]),n("Legend",{attrs:{data:e.legendData,id:"legend"}})],1),e.spinShow?n("Spin",{attrs:{size:"large",fix:""}}):e._e()],1)},r=[],i=(n("96cf"),n("3b8d")),s=n("9ed9"),o=n("149e"),c=n("f831"),u=n("cf45"),d=n("42e8"),p=n.n(d),l=n("39f3"),h=n.n(l),f=n("136f"),m=n("3cf7"),b=n.n(m),w=n("6c68"),g=n.n(w),v=(n("2b03"),n("b775")),x=function(e){return Object(v["a"])({url:"/user/listPhoneUserToView",method:"post",data:e})},y={name:"workRegulation",data:function(){return{legendData:[{type:1,name:"离线",background:"url("+b.a+")",id:"patrolUserGray"},{type:1,name:"在线",background:"url("+g.a+")",id:"patrolUserRed"}],popupTemplate:{},loadComplete:!1,spinShow:!0}},components:{Legend:f["a"]},mounted:function(){this.createMap(),this.getLedgerList()},methods:{getLedgerList:function(){var e=Object(i["a"])(regeneratorRuntime.mark(function e(){var t=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,x({data:{}}).then(function(e){"0000"===e.data.code&&t.addPointToMap(e.data.data.data,o["a"].inflectionPointcolor,"graphicsLayer_patroluser")}).catch(function(){t.$Notice.error({title:"服务器错误"})});case 2:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),createMap:function(){var e=Object(i["a"])(regeneratorRuntime.mark(function e(){var t,n,a,r,i,u,d,l,f,m,b,w,g=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,s["a"].MapView;case 2:return t=e.sent,e.next=5,s["a"].Map;case 5:return n=e.sent,e.next=8,s["a"].Basemap;case 8:return a=e.sent,e.next=11,s["a"].BasemapToggle;case 11:return r=e.sent,e.next=14,Object(c["f"])().then(function(e){return e});case 14:return i=e.sent,e.next=17,Object(c["e"])().then(function(e){return e});case 17:return u=e.sent,e.next=20,Object(c["d"])().then(function(e){return e});case 20:return d=e.sent,e.next=23,Object(c["g"])().then(function(e){return e});case 23:return l=e.sent,e.next=26,Object(c["b"])().then(function(e){return e});case 26:f=e.sent,m=new a({baseLayers:[u,f,d],title:"矢量地图",id:"myBasemap",thumbnailUrl:p.a}),b=new a({baseLayers:[i,f,l],title:"影像地图",id:"myBasemap1",thumbnailUrl:h.a}),this.map=new n({basemap:b}),this.view=new t({map:this.map,container:"viewDiv",center:o["a"].centerPoint,zoom:7}),this.view.when(function(e){g.loadComplete=!0}),this.popupTemplate={title:"巡查人员详情",content:[{type:"fields",fieldInfos:[{fieldName:"用户名"},{fieldName:"手机号"},{fieldName:"真实姓名"},{fieldName:"经度"},{fieldName:"纬度"},{fieldName:"邮箱"}]}]},w=new r({view:this.view,nextBasemap:m}),this.view.ui.add(w,"top-right"),this.view.ui.add(document.getElementById("legendbar"),"bottom-left");case 36:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),addPointToMap:function(){var e=Object(i["a"])(regeneratorRuntime.mark(function e(t,n,a){var r,i,o,c,d,p,l,h,f,m,w,v,x,y,k,C;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,s["a"].GraphicsLayer;case 2:return r=e.sent,e.next=5,s["a"].Graphic;case 5:if(i=e.sent,o=this.map.findLayerById(a),c={},w=[],o&&this.map.remove(o),v=new r({id:a,elevationInfo:"on-the-ground",title:"实时位置"}),!(t&&t.length>0)){e.next=34;break}x=0;case 13:if(!(x<t.length)){e.next=34;break}if(null!==t[x].CH003){e.next=18;break}return e.abrupt("continue",31);case 18:-1!==t[x].CH003.indexOf("°")?(f=Object(u["a"])(t[x].CH003),m=Object(u["a"])(t[x].CH004)):-1!==t[x].CH003.indexOf(".")&&(f=t[x].CH003,m=t[x].CH004);case 19:c={type:"point",longitude:f,latitude:m},0===t[x].CH005?(l=b.a,h="离线"):1===t[x].CH005&&(l=g.a,h="在线"),y={id:t[x].SA001,"用户名":t[x].SA008,"手机号":'<a style="color: blue">'+t[x].SA012+"</a>","真实姓名":t[x].SA019,"经度":f,"纬度":m,"邮箱":t[x].SA013,"状态":h},0===t[x].CH005&&(y["手机号"]='<a style="color: blue">'+t[x].SA012+"</a>"),k={type:"picture-marker",url:l,width:20,height:20,outline:{color:[255,255,255],width:1}},C={type:"text",color:"white",haloColor:"black",haloSize:"1px",text:t[x].SA019,xoffset:0,yoffset:-20,font:{size:12,family:"sans-serif",weight:"bold"}},d=new i({geometry:c,symbol:k,attributes:y,popupTemplate:this.popupTemplate}),p=new i({geometry:c,symbol:C}),w.push(d),w.push(p),v.add(d),v.add(p);case 31:x++,e.next=13;break;case 34:this.spinShow=!1,this.map.add(v);case 36:case"end":return e.stop()}},e,this)}));function t(t,n,a){return e.apply(this,arguments)}return t}()}},k=y,C=(n("e6ad"),n("2877")),O=Object(C["a"])(k,a,r,!1,null,"2c7d554e",null);t["default"]=O.exports},d64b:function(e,t,n){},e6ad:function(e,t,n){"use strict";var a=n("d64b"),r=n.n(a);r.a}}]);
//# sourceMappingURL=chunk-8d469e5c.20363af9.js.map